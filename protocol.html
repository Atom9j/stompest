

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Protocol Layer &mdash; stompest documentation - v2.0a3</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '2.0a3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="stompest documentation - v2.0a3" href="index.html" />
    <link rel="next" title="Configuration" href="config.html" />
    <link rel="prev" title="Asynchronous Client" href="async.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="config.html" title="Configuration"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="async.html" title="Asynchronous Client"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">stompest documentation - v2.0a3</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Protocol Layer</a><ul>
<li><a class="reference internal" href="#module-stompest.protocol.failover">Failover Transport</a></li>
<li><a class="reference internal" href="#module-stompest.protocol.session">Session State</a></li>
<li><a class="reference internal" href="#module-stompest.protocol.frame">STOMP Frame Representation</a></li>
<li><a class="reference internal" href="#commands">Commands</a></li>
<li><a class="reference internal" href="#module-stompest.protocol.spec">STOMP Protocol Specification</a></li>
<li><a class="reference internal" href="#module-stompest.protocol.parser">Wire-Level Parser</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="async.html"
                        title="previous chapter">Asynchronous Client</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="config.html"
                        title="next chapter">Configuration</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/protocol.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-stompest.protocol">
<span id="protocol-layer"></span><span id="protocol"></span><h1>Protocol Layer<a class="headerlink" href="#module-stompest.protocol" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference internal" href="#module-stompest.protocol" title="stompest.protocol"><tt class="xref py py-mod docutils literal"><span class="pre">protocol</span></tt></a> package is a collection of generic components each of which you can use independently for your own STOMP related functionality.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Please restrict your imports to the main package <a class="reference internal" href="#module-stompest.protocol" title="stompest.protocol"><tt class="xref py py-mod docutils literal"><span class="pre">stompest.protocol</span></tt></a>. The subpackage structure is potentially unstable.</p>
</div>
<div class="section" id="module-stompest.protocol.failover">
<span id="failover-transport"></span><h2>Failover Transport<a class="headerlink" href="#module-stompest.protocol.failover" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="stompest.protocol.failover.StompFailoverTransport">
<em class="property">class </em><tt class="descclassname">stompest.protocol.failover.</tt><tt class="descname">StompFailoverTransport</tt><big>(</big><em>uri</em><big>)</big><a class="headerlink" href="#stompest.protocol.failover.StompFailoverTransport" title="Permalink to this definition">¶</a></dt>
<dd><p>Looping over this object, you can produce a series of tuples (broker, delay in s). When the failover scheme does not allow further failover, a <tt class="xref py py-class docutils literal"><span class="pre">StompConnectTimeout</span></tt> error is raised.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>uri</strong> &#8211; A failover URI.</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">stompest.protocol</span> <span class="kn">import</span> <span class="n">StompFailoverTransport</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">stompest.error</span> <span class="kn">import</span> <span class="n">StompConnectTimeout</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">failover</span> <span class="o">=</span> <span class="n">StompFailoverTransport</span><span class="p">(</span><span class="s">&#39;failover:(tcp://remote1:61615,tcp://localhost:61616)?randomize=false,startupMaxReconnectAttempts=3,initialReconnectDelay=7,maxReconnectDelay=8,maxReconnectAttempts=0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="p">(</span><span class="n">broker</span><span class="p">,</span> <span class="n">delay</span><span class="p">)</span> <span class="ow">in</span> <span class="n">failover</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">print</span> <span class="s">&#39;broker: </span><span class="si">%s</span><span class="s">, delay: </span><span class="si">%f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">broker</span><span class="p">,</span> <span class="n">delay</span><span class="p">)</span>                                                                       
<span class="gp">... </span><span class="k">except</span> <span class="n">StompConnectTimeout</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="s">&#39;timeout: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">e</span>
<span class="gp">... </span>
<span class="go">broker: {&#39;host&#39;: &#39;remote1&#39;, &#39;protocol&#39;: &#39;tcp&#39;, &#39;port&#39;: 61615}, delay: 0.000000</span>
<span class="go">broker: {&#39;host&#39;: &#39;localhost&#39;, &#39;protocol&#39;: &#39;tcp&#39;, &#39;port&#39;: 61616}, delay: 0.007000</span>
<span class="go">broker: {&#39;host&#39;: &#39;remote1&#39;, &#39;protocol&#39;: &#39;tcp&#39;, &#39;port&#39;: 61615}, delay: 0.008000</span>
<span class="go">broker: {&#39;host&#39;: &#39;localhost&#39;, &#39;protocol&#39;: &#39;tcp&#39;, &#39;port&#39;: 61616}, delay: 0.008000</span>
<span class="go">timeout: Reconnect timeout: 3 attempts</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="p">(</span><span class="n">broker</span><span class="p">,</span> <span class="n">delay</span><span class="p">)</span> <span class="ow">in</span> <span class="n">failover</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">print</span> <span class="s">&#39;broker: </span><span class="si">%s</span><span class="s">, delay: </span><span class="si">%f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">broker</span><span class="p">,</span> <span class="n">delay</span><span class="p">)</span>
<span class="gp">... </span><span class="k">except</span> <span class="n">StompConnectTimeout</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="s">&#39;timeout: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">e</span>
<span class="gp">... </span>
<span class="go">broker: {&#39;host&#39;: &#39;remote1&#39;, &#39;protocol&#39;: &#39;tcp&#39;, &#39;port&#39;: 61615}, delay: 0.000000</span>
<span class="go">timeout: Reconnect timeout: 0 attempts</span>
</pre></div>
</div>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">The <a class="reference internal" href="#stompest.protocol.failover.StompFailoverUri" title="stompest.protocol.failover.StompFailoverUri"><tt class="xref py py-class docutils literal"><span class="pre">StompFailoverUri</span></tt></a> which parses failover transport URIs.</p>
</div>
</dd></dl>

<dl class="class">
<dt id="stompest.protocol.failover.StompFailoverUri">
<em class="property">class </em><tt class="descclassname">stompest.protocol.failover.</tt><tt class="descname">StompFailoverUri</tt><big>(</big><em>uri</em><big>)</big><a class="headerlink" href="#stompest.protocol.failover.StompFailoverUri" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a parser for the failover URI scheme used in stompest. The parsed parameters are available in the attributes <tt class="xref py py-attr docutils literal"><span class="pre">brokers</span></tt> and <tt class="xref py py-attr docutils literal"><span class="pre">options</span></tt>. The Failover transport syntax is very close to the one used in ActiveMQ.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>uri</strong> &#8211; <p>A failover URI. Its basic form is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="s">&#39;failover:(uri1,...,uriN)?transportOptions&#39;</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="s">&#39;failover:uri1,...,uriN&#39;</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<p><strong>Example:</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">stompest.protocol</span> <span class="kn">import</span> <span class="n">StompFailoverUri</span>    
<span class="gp">&gt;&gt;&gt; </span><span class="n">uri</span> <span class="o">=</span> <span class="n">StompFailoverUri</span><span class="p">(</span><span class="s">&#39;failover:(tcp://remote1:61615,tcp://localhost:61616)?randomize=false,startupMaxReconnectAttempts=3,initialReconnectDelay=7,maxReconnectDelay=8,maxReconnectAttempts=0&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">uri</span><span class="o">.</span><span class="n">brokers</span>
<span class="go">[{&#39;host&#39;: &#39;remote1&#39;, &#39;protocol&#39;: &#39;tcp&#39;, &#39;port&#39;: 61615}, {&#39;host&#39;: &#39;localhost&#39;, &#39;protocol&#39;: &#39;tcp&#39;, &#39;port&#39;: 61616}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">uri</span><span class="o">.</span><span class="n">options</span>
<span class="go">{&#39;initialReconnectDelay&#39;: 7, &#39;maxReconnectDelay&#39;: 8, &#39;backOffMultiplier&#39;: 2.0, &#39;startupMaxReconnectAttempts&#39;: 3, &#39;priorityBackup&#39;: False, &#39;maxReconnectAttempts&#39;: 0, &#39;reconnectDelayJitter&#39;: 0, &#39;useExponentialBackOff&#39;: True, &#39;randomize&#39;: False}</span>
</pre></div>
</div>
<p><strong>Supported Options:</strong></p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="3%" />
<col width="5%" />
<col width="82%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">option</th>
<th class="head">type</th>
<th class="head">default</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><em>initialReconnectDelay</em></td>
<td>int</td>
<td><tt class="xref py py-obj docutils literal"><span class="pre">10</span></tt></td>
<td>how long to wait before the first reconnect attempt (in ms)</td>
</tr>
<tr class="row-odd"><td><em>maxReconnectDelay</em></td>
<td>int</td>
<td><tt class="xref py py-obj docutils literal"><span class="pre">30000</span></tt></td>
<td>the maximum amount of time we ever wait between reconnect attempts (in ms)</td>
</tr>
<tr class="row-even"><td><em>useExponentialBackOff</em></td>
<td>bool</td>
<td><tt class="xref py py-obj docutils literal"><span class="pre">True</span></tt></td>
<td>should an exponential backoff be used between reconnect attempts</td>
</tr>
<tr class="row-odd"><td><em>backOffMultiplier</em></td>
<td>float</td>
<td><tt class="xref py py-obj docutils literal"><span class="pre">2.0</span></tt></td>
<td>the exponent used in the exponential backoff attempts</td>
</tr>
<tr class="row-even"><td><em>maxReconnectAttempts</em></td>
<td>int</td>
<td><tt class="xref py py-obj docutils literal"><span class="pre">-1</span></tt></td>
<td><tt class="xref py py-obj docutils literal"><span class="pre">-1</span></tt> means retry forever
<tt class="xref py py-obj docutils literal"><span class="pre">0</span></tt> means don&#8217;t retry (only try connection once but no retry)
<tt class="xref py py-obj docutils literal"><span class="pre">&gt;</span> <span class="pre">0</span></tt> means the maximum number of reconnect attempts before an error is sent back to the client</td>
</tr>
<tr class="row-odd"><td><em>startupMaxReconnectAttempts</em></td>
<td>int</td>
<td><tt class="xref py py-obj docutils literal"><span class="pre">0</span></tt></td>
<td>if not <tt class="xref py py-obj docutils literal"><span class="pre">0</span></tt>, then this is the maximum number of reconnect attempts before an error is sent back to the client on the first attempt by the client to start a connection, once connected the <em>maxReconnectAttempts</em> option takes precedence</td>
</tr>
<tr class="row-even"><td><em>reconnectDelayJitter</em></td>
<td>int</td>
<td><tt class="xref py py-obj docutils literal"><span class="pre">0</span></tt></td>
<td>jitter in ms by which reconnect delay is blurred in order to avoid stampeding</td>
</tr>
<tr class="row-odd"><td><em>randomize</em></td>
<td>bool</td>
<td><tt class="xref py py-obj docutils literal"><span class="pre">True</span></tt></td>
<td>use a random algorithm to choose the the URI to use for reconnect from the list provided</td>
</tr>
<tr class="row-even"><td><em>priorityBackup</em></td>
<td>bool</td>
<td><tt class="xref py py-obj docutils literal"><span class="pre">False</span></tt></td>
<td>if set, prefer local connections to remote connections</td>
</tr>
</tbody>
</table>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#stompest.protocol.failover.StompFailoverTransport" title="stompest.protocol.failover.StompFailoverTransport"><tt class="xref py py-class docutils literal"><span class="pre">StompFailoverTransport</span></tt></a>, <a class="reference external" href="http://activemq.apache.org/failover-transport-reference.html">failover transport</a> of ActiveMQ.</p>
</div>
</dd></dl>

</div>
<div class="section" id="module-stompest.protocol.session">
<span id="session-state"></span><span id="session"></span><h2>Session State<a class="headerlink" href="#module-stompest.protocol.session" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="#stompest.protocol.session.StompSession" title="stompest.protocol.session.StompSession"><tt class="xref py py-class docutils literal"><span class="pre">StompSession</span></tt></a> object implements an abstract STOMP protocol session, where &#8220;abstract&#8221; means that it is entirely client or transport agnostic. The session API builds upon the low-level and stateless API of the <a class="reference internal" href="#module-stompest.protocol.commands" title="stompest.protocol.commands"><tt class="xref py py-mod docutils literal"><span class="pre">protocol.commands</span></tt></a> module, but it also keeps track of the session state (e.g., STOMP protocol version negotiation, active subscriptions). You can use the API provided by <a class="reference internal" href="#stompest.protocol.session.StompSession" title="stompest.protocol.session.StompSession"><tt class="xref py py-class docutils literal"><span class="pre">StompSession</span></tt></a> independently of the stompest clients to roll your own STOMP client.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Being stateful implies that the session keeps track of subscriptions, receipts, and transactions, so keep track of them yourself, too! &#8211; Unless you like to be surprised by a spurious <tt class="xref py py-class docutils literal"><span class="pre">StompProtocolError</span></tt> ...</p>
</div>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">The stateless API in the module <a class="reference internal" href="#module-stompest.protocol.commands" title="stompest.protocol.commands"><tt class="xref py py-mod docutils literal"><span class="pre">protocol.commands</span></tt></a> for all API command parameters which are not documented here.</p>
</div>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">stompest.protocol</span> <span class="kn">import</span> <span class="n">StompFrame</span><span class="p">,</span> <span class="n">StompSession</span><span class="p">,</span> <span class="n">StompSpec</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">session</span> <span class="o">=</span> <span class="n">StompSession</span><span class="p">(</span><span class="s">&#39;1.1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">session</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">login</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">passcode</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
<span class="go">StompFrame(command=u&#39;CONNECT&#39;, headers={u&#39;passcode&#39;: &#39;&#39;, u&#39;login&#39;: &#39;&#39;, u&#39;host&#39;: &#39;&#39;, u&#39;accept-version&#39;: &#39;1.0,1.1&#39;}, body=&#39;&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">session</span><span class="o">.</span><span class="n">version</span><span class="p">,</span> <span class="n">session</span><span class="o">.</span><span class="n">state</span>
<span class="go">1.1 connecting</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">session</span><span class="o">.</span><span class="n">connected</span><span class="p">(</span><span class="n">StompFrame</span><span class="p">(</span><span class="n">StompSpec</span><span class="o">.</span><span class="n">CONNECTED</span><span class="p">,</span> <span class="p">{</span><span class="n">StompSpec</span><span class="o">.</span><span class="n">SESSION_HEADER</span><span class="p">:</span> <span class="s">&#39;tete-a-tete&#39;</span><span class="p">}))</span> <span class="c"># The broker only understands STOMP 1.0.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">session</span><span class="o">.</span><span class="n">version</span><span class="p">,</span> <span class="n">session</span><span class="o">.</span><span class="n">state</span>
<span class="go">1.0 connected</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">session</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
<span class="go">StompFrame(command=u&#39;DISCONNECT&#39;, headers={}, body=&#39;&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">session</span><span class="o">.</span><span class="n">version</span><span class="p">,</span> <span class="n">session</span><span class="o">.</span><span class="n">state</span>
<span class="go">1.0 disconnecting</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">session</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">session</span><span class="o">.</span><span class="n">version</span><span class="p">,</span> <span class="n">session</span><span class="o">.</span><span class="n">state</span>
<span class="go">1.1 disconnected</span>
</pre></div>
</div>
<dl class="class">
<dt id="stompest.protocol.session.StompSession">
<em class="property">class </em><tt class="descclassname">stompest.protocol.session.</tt><tt class="descname">StompSession</tt><big>(</big><em>version=None</em>, <em>check=True</em><big>)</big><a class="headerlink" href="#stompest.protocol.session.StompSession" title="Permalink to this definition">¶</a></dt>
<dd><p>This object implements an abstract STOMP protocol session.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>version</strong> &#8211; The highest (and at the same time default) STOMP protocol version.</li>
<li><strong>check</strong> &#8211; This flag decides whether the session should accept commands only in the proper session states (<tt class="xref py py-obj docutils literal"><span class="pre">True</span></tt>) or in any session state (<tt class="xref py py-obj docutils literal"><span class="pre">False</span></tt>).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="stompest.protocol.session.StompSession.abort">
<tt class="descname">abort</tt><big>(</big><em>transaction</em>, <em>receipt=None</em><big>)</big><a class="headerlink" href="#stompest.protocol.session.StompSession.abort" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an <strong>ABORT</strong> frame to abort a STOMP transaction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>transaction</strong> &#8211; See <a class="reference internal" href="#stompest.protocol.session.StompSession.transaction" title="stompest.protocol.session.StompSession.transaction"><tt class="xref py py-meth docutils literal"><span class="pre">transaction()</span></tt></a>.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you try and abort a transaction which is not pending, this will result in a <tt class="xref py py-class docutils literal"><span class="pre">StompProtocolError</span></tt>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.ack">
<tt class="descname">ack</tt><big>(</big><em>frame</em>, <em>receipt=None</em><big>)</big><a class="headerlink" href="#stompest.protocol.session.StompSession.ack" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an <strong>ACK</strong> frame for a received <strong>MESSAGE</strong> frame.</p>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.beat">
<tt class="descname">beat</tt><big>(</big><big>)</big><a class="headerlink" href="#stompest.protocol.session.StompSession.beat" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a STOMP heart-beat.</p>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.begin">
<tt class="descname">begin</tt><big>(</big><em>transaction=None</em>, <em>receipt=None</em><big>)</big><a class="headerlink" href="#stompest.protocol.session.StompSession.begin" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <strong>BEGIN</strong> frame and begin an abstract STOMP transaction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>transaction</strong> &#8211; See <a class="reference internal" href="#stompest.protocol.session.StompSession.transaction" title="stompest.protocol.session.StompSession.transaction"><tt class="xref py py-meth docutils literal"><span class="pre">transaction()</span></tt></a>.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you try and begin a pending transaction twice, this will result in a <tt class="xref py py-class docutils literal"><span class="pre">StompProtocolError</span></tt>.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="stompest.protocol.session.StompSession.clientHeartBeat">
<tt class="descname">clientHeartBeat</tt><a class="headerlink" href="#stompest.protocol.session.StompSession.clientHeartBeat" title="Permalink to this definition">¶</a></dt>
<dd><p>The negotiated client heart-beat period in ms.</p>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.close">
<tt class="descname">close</tt><big>(</big><em>flush=True</em><big>)</big><a class="headerlink" href="#stompest.protocol.session.StompSession.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Clean up the session: Set the state to <tt class="xref py py-attr docutils literal"><span class="pre">DISCONNECTED</span></tt>, remove all information related to an eventual broker connection, clear all pending transactions and receipts.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>flush</strong> &#8211; Clear all active subscriptions. This flag controls whether the next <a class="reference internal" href="#stompest.protocol.session.StompSession.connect" title="stompest.protocol.session.StompSession.connect"><tt class="xref py py-meth docutils literal"><span class="pre">connect()</span></tt></a> will replay the currently active subscriptions or will wipe the slate clean.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.commit">
<tt class="descname">commit</tt><big>(</big><em>transaction</em>, <em>receipt=None</em><big>)</big><a class="headerlink" href="#stompest.protocol.session.StompSession.commit" title="Permalink to this definition">¶</a></dt>
<dd><p>Send a <strong>COMMIT</strong> command to commit a STOMP transaction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>transaction</strong> &#8211; See <a class="reference internal" href="#stompest.protocol.session.StompSession.transaction" title="stompest.protocol.session.StompSession.transaction"><tt class="xref py py-meth docutils literal"><span class="pre">transaction()</span></tt></a>.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you try and commit a transaction which is not pending, this will result in a <tt class="xref py py-class docutils literal"><span class="pre">StompProtocolError</span></tt>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.connect">
<tt class="descname">connect</tt><big>(</big><em>login=None</em>, <em>passcode=None</em>, <em>headers=None</em>, <em>versions=None</em>, <em>host=None</em>, <em>heartBeats=None</em><big>)</big><a class="headerlink" href="#stompest.protocol.session.StompSession.connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <strong>CONNECT</strong> frame and set the session state to <tt class="xref py py-attr docutils literal"><span class="pre">CONNECTING</span></tt>.</p>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.connected">
<tt class="descname">connected</tt><big>(</big><em>frame</em><big>)</big><a class="headerlink" href="#stompest.protocol.session.StompSession.connected" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle a <strong>CONNECTED</strong> frame and set the session state to <tt class="xref py py-attr docutils literal"><span class="pre">CONNECTED</span></tt>.</p>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.disconnect">
<tt class="descname">disconnect</tt><big>(</big><em>receipt=None</em><big>)</big><a class="headerlink" href="#stompest.protocol.session.StompSession.disconnect" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <strong>DISCONNECT</strong> frame and set the session state to <tt class="xref py py-attr docutils literal"><span class="pre">DISCONNECTING</span></tt>.</p>
</dd></dl>

<dl class="attribute">
<dt id="stompest.protocol.session.StompSession.id">
<tt class="descname">id</tt><a class="headerlink" href="#stompest.protocol.session.StompSession.id" title="Permalink to this definition">¶</a></dt>
<dd><p>The session id for the current client-broker connection.</p>
</dd></dl>

<dl class="attribute">
<dt id="stompest.protocol.session.StompSession.lastReceived">
<tt class="descname">lastReceived</tt><a class="headerlink" href="#stompest.protocol.session.StompSession.lastReceived" title="Permalink to this definition">¶</a></dt>
<dd><p>The last time when data was received.</p>
</dd></dl>

<dl class="attribute">
<dt id="stompest.protocol.session.StompSession.lastSent">
<tt class="descname">lastSent</tt><a class="headerlink" href="#stompest.protocol.session.StompSession.lastSent" title="Permalink to this definition">¶</a></dt>
<dd><p>The last time when data was sent.</p>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.message">
<tt class="descname">message</tt><big>(</big><em>frame</em><big>)</big><a class="headerlink" href="#stompest.protocol.session.StompSession.message" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle a <strong>MESSAGE</strong> frame. Returns a token which you can use to match this message to its subscription.</p>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">The <a class="reference internal" href="#stompest.protocol.session.StompSession.subscribe" title="stompest.protocol.session.StompSession.subscribe"><tt class="xref py py-meth docutils literal"><span class="pre">subscribe()</span></tt></a> method.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.nack">
<tt class="descname">nack</tt><big>(</big><em>frame</em>, <em>receipt=None</em><big>)</big><a class="headerlink" href="#stompest.protocol.session.StompSession.nack" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <strong>NACK</strong> frame for a received <strong>MESSAGE</strong> frame.</p>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.receipt">
<tt class="descname">receipt</tt><big>(</big><em>frame</em><big>)</big><a class="headerlink" href="#stompest.protocol.session.StompSession.receipt" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle a <strong>RECEIPT</strong> frame. Returns the receipt id which you can use to match this receipt to the command that requested it.</p>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.received">
<tt class="descname">received</tt><big>(</big><big>)</big><a class="headerlink" href="#stompest.protocol.session.StompSession.received" title="Permalink to this definition">¶</a></dt>
<dd><p>Notify the session that data was received (counts as server heart-beat).</p>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.replay">
<tt class="descname">replay</tt><big>(</big><big>)</big><a class="headerlink" href="#stompest.protocol.session.StompSession.replay" title="Permalink to this definition">¶</a></dt>
<dd><p>Flush all active subscriptions and return an iterator over the <a class="reference internal" href="#stompest.protocol.session.StompSession.subscribe" title="stompest.protocol.session.StompSession.subscribe"><tt class="xref py py-meth docutils literal"><span class="pre">subscribe()</span></tt></a> parameters (<strong>destinations</strong>, <strong>header</strong>, <strong>receipt</strong>, <strong>context</strong>) which you can consume to replay the subscriptions upon the next <a class="reference internal" href="#stompest.protocol.session.StompSession.connect" title="stompest.protocol.session.StompSession.connect"><tt class="xref py py-meth docutils literal"><span class="pre">connect()</span></tt></a>.</p>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.send">
<tt class="descname">send</tt><big>(</big><em>destination</em>, <em>body=''</em>, <em>headers=None</em>, <em>receipt=None</em><big>)</big><a class="headerlink" href="#stompest.protocol.session.StompSession.send" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <strong>SEND</strong> frame.</p>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.sent">
<tt class="descname">sent</tt><big>(</big><big>)</big><a class="headerlink" href="#stompest.protocol.session.StompSession.sent" title="Permalink to this definition">¶</a></dt>
<dd><p>Notify the session that data was sent (counts as client heart-beat).</p>
</dd></dl>

<dl class="attribute">
<dt id="stompest.protocol.session.StompSession.server">
<tt class="descname">server</tt><a class="headerlink" href="#stompest.protocol.session.StompSession.server" title="Permalink to this definition">¶</a></dt>
<dd><p>The server id for the current client-broker connection.</p>
</dd></dl>

<dl class="attribute">
<dt id="stompest.protocol.session.StompSession.serverHeartBeat">
<tt class="descname">serverHeartBeat</tt><a class="headerlink" href="#stompest.protocol.session.StompSession.serverHeartBeat" title="Permalink to this definition">¶</a></dt>
<dd><p>The negotiated server heart-beat period in ms.</p>
</dd></dl>

<dl class="attribute">
<dt id="stompest.protocol.session.StompSession.state">
<tt class="descname">state</tt><a class="headerlink" href="#stompest.protocol.session.StompSession.state" title="Permalink to this definition">¶</a></dt>
<dd><p>The current session state.</p>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.subscribe">
<tt class="descname">subscribe</tt><big>(</big><em>destination</em>, <em>headers=None</em>, <em>receipt=None</em>, <em>context=None</em><big>)</big><a class="headerlink" href="#stompest.protocol.session.StompSession.subscribe" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <strong>SUBSCRIBE</strong> frame and keep track of the subscription assiocated to it. This method returns a token which you have to keep if you wish to match incoming <strong>MESSAGE</strong> frames to this subscription with <a class="reference internal" href="#stompest.protocol.session.StompSession.message" title="stompest.protocol.session.StompSession.message"><tt class="xref py py-meth docutils literal"><span class="pre">message()</span></tt></a> or to <a class="reference internal" href="#stompest.protocol.session.StompSession.unsubscribe" title="stompest.protocol.session.StompSession.unsubscribe"><tt class="xref py py-meth docutils literal"><span class="pre">unsubscribe()</span></tt></a> later.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>context</strong> &#8211; An arbitrary context object which you can use to store any information related to the subscription at hand.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.transaction">
<tt class="descname">transaction</tt><big>(</big><em>transaction=None</em><big>)</big><a class="headerlink" href="#stompest.protocol.session.StompSession.transaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a transaction id which can be used for <a class="reference internal" href="#stompest.protocol.session.StompSession.begin" title="stompest.protocol.session.StompSession.begin"><tt class="xref py py-meth docutils literal"><span class="pre">begin()</span></tt></a>, <a class="reference internal" href="#stompest.protocol.session.StompSession.abort" title="stompest.protocol.session.StompSession.abort"><tt class="xref py py-meth docutils literal"><span class="pre">abort()</span></tt></a>, and <a class="reference internal" href="#stompest.protocol.session.StompSession.commit" title="stompest.protocol.session.StompSession.commit"><tt class="xref py py-meth docutils literal"><span class="pre">commit()</span></tt></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>transaction</strong> &#8211; A valid transaction id, or <tt class="xref py py-obj docutils literal"><span class="pre">None</span></tt> (automatically generate a unique id).</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.session.StompSession.unsubscribe">
<tt class="descname">unsubscribe</tt><big>(</big><em>token</em>, <em>receipt=None</em><big>)</big><a class="headerlink" href="#stompest.protocol.session.StompSession.unsubscribe" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an <strong>UNSUBSCRIBE</strong> frame and lose track of the subscription assiocated to it.</p>
</dd></dl>

<dl class="attribute">
<dt id="stompest.protocol.session.StompSession.version">
<tt class="descname">version</tt><a class="headerlink" href="#stompest.protocol.session.StompSession.version" title="Permalink to this definition">¶</a></dt>
<dd><p>The STOMP protocol version of the current client-broker connection (if any), or the version you created this session with (otherwise).</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-stompest.protocol.frame">
<span id="stomp-frame-representation"></span><span id="frame"></span><h2>STOMP Frame Representation<a class="headerlink" href="#module-stompest.protocol.frame" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="stompest.protocol.frame.StompFrame">
<em class="property">class </em><tt class="descclassname">stompest.protocol.frame.</tt><tt class="descname">StompFrame</tt><big>(</big><em>command</em>, <em>headers=None</em>, <em>body=''</em>, <em>version=None</em><big>)</big><a class="headerlink" href="#stompest.protocol.frame.StompFrame" title="Permalink to this definition">¶</a></dt>
<dd><p>This object represents a STOMP frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>command</strong> &#8211; A valid STOMP command.</li>
<li><strong>headers</strong> &#8211; The STOMP headers (represented as a <tt class="xref py py-class docutils literal"><span class="pre">dict</span></tt>), or <tt class="xref py py-obj docutils literal"><span class="pre">None</span></tt> (no headers).</li>
<li><strong>body</strong> &#8211; The frame body.</li>
<li><strong>version</strong> &#8211; A valid STOMP protocol version, or <tt class="xref py py-obj docutils literal"><span class="pre">None</span></tt> (equivalent to the <tt class="xref py py-attr docutils literal"><span class="pre">DEFAULT_VERSION</span></tt> attribute of the <a class="reference internal" href="#stompest.protocol.spec.StompSpec" title="stompest.protocol.spec.StompSpec"><tt class="xref py py-class docutils literal"><span class="pre">StompSpec</span></tt></a> class).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The frame&#8217;s attributes are internally stored as arbitrary Python objects. The frame&#8217;s <tt class="xref py py-attr docutils literal"><span class="pre">version</span></tt> attribute controls the wire-level encoding of its <tt class="xref py py-attr docutils literal"><span class="pre">command</span></tt> and <tt class="xref py py-attr docutils literal"><span class="pre">headers</span></tt> (depending on STOMP protocol version, this may be ASCII or UTF-8), while its <tt class="xref py py-attr docutils literal"><span class="pre">body</span></tt> is not encoded at all (it&#8217;s just cast as a <tt class="xref py py-class docutils literal"><span class="pre">str</span></tt>).</p>
</div>
<dl class="method">
<dt id="stompest.protocol.frame.StompFrame.info">
<tt class="descname">info</tt><big>(</big><big>)</big><a class="headerlink" href="#stompest.protocol.frame.StompFrame.info" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce a log-friendly representation of the frame (show only non-trivial content, and truncate the message to INFO_LENGTH characters.)</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="stompest.protocol.frame.StompHeartBeat">
<em class="property">class </em><tt class="descclassname">stompest.protocol.frame.</tt><tt class="descname">StompHeartBeat</tt><a class="headerlink" href="#stompest.protocol.frame.StompHeartBeat" title="Permalink to this definition">¶</a></dt>
<dd><p>This object represents a STOMP heart-beat. Its string representation (via <tt class="xref py py-meth docutils literal"><span class="pre">__str__()</span></tt>) renders the wire-level STOMP heart-beat.</p>
</dd></dl>

</div>
<div class="section" id="commands">
<span id="id2"></span><h2>Commands<a class="headerlink" href="#commands" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-stompest.protocol.commands"></span><p>This module implements a low-level and stateless API for all commands of the STOMP protocol version supported by stompest. All STOMP command frames are represented as <a class="reference internal" href="#stompest.protocol.frame.StompFrame" title="stompest.protocol.frame.StompFrame"><tt class="xref py py-class docutils literal"><span class="pre">StompFrame</span></tt></a> objects. It forms the basis for <a class="reference internal" href="#stompest.protocol.session.StompSession" title="stompest.protocol.session.StompSession"><tt class="xref py py-class docutils literal"><span class="pre">StompSession</span></tt></a> which represents the full state of an abstract STOMP protocol session and (via <a class="reference internal" href="#stompest.protocol.session.StompSession" title="stompest.protocol.session.StompSession"><tt class="xref py py-class docutils literal"><span class="pre">StompSession</span></tt></a>) of both high-level STOMP clients. You can use the commands API independently of other stompest modules to roll your own STOMP related functionality.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Whenever you have to pass a <strong>version</strong> parameter to a command, this is because the behavior of that command depends on the STOMP protocol version of your current session. The default version is the value of <tt class="xref py py-attr docutils literal"><span class="pre">StompSpec.DEFAULT_VERSION</span></tt>, which is currently <tt class="xref py py-obj docutils literal"><span class="pre">'1.0'</span></tt> but may change in upcoming versions of stompest (and by you, if you wish to override it). Any command which does not conform to the STOMP protocol version in question will result in a <tt class="xref py py-class docutils literal"><span class="pre">StompProtocolError</span></tt>.</p>
</div>
<p>Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">stompest.protocol</span> <span class="kn">import</span> <span class="n">commands</span><span class="p">,</span> <span class="n">StompFrame</span><span class="p">,</span> <span class="n">StompSpec</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">versions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">commands</span><span class="o">.</span><span class="n">versions</span><span class="p">(</span><span class="s">&#39;1.1&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">versions</span>
<span class="go">[&#39;1.0&#39;, &#39;1.1&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="nb">repr</span><span class="p">(</span><span class="n">commands</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">versions</span><span class="o">=</span><span class="n">versions</span><span class="p">))</span>
<span class="go">StompFrame(command=u&#39;CONNECT&#39;, headers={u&#39;host&#39;: &#39;&#39;, u&#39;accept-version&#39;: &#39;1.0,1.1&#39;}, body=&#39;&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span><span class="p">,</span> <span class="n">token</span> <span class="o">=</span> <span class="n">commands</span><span class="o">.</span><span class="n">subscribe</span><span class="p">(</span><span class="s">&#39;/queue/test&#39;</span><span class="p">,</span> <span class="p">{</span><span class="n">StompSpec</span><span class="o">.</span><span class="n">ACK_HEADER</span><span class="p">:</span> <span class="s">&#39;client-individual&#39;</span><span class="p">,</span> <span class="s">&#39;activemq.prefetchSize&#39;</span><span class="p">:</span> <span class="s">&#39;100&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame</span> <span class="o">=</span> <span class="n">StompFrame</span><span class="p">(</span><span class="n">StompSpec</span><span class="o">.</span><span class="n">MESSAGE</span><span class="p">,</span> <span class="p">{</span><span class="n">StompSpec</span><span class="o">.</span><span class="n">DESTINATION_HEADER</span><span class="p">:</span> <span class="s">&#39;/queue/test&#39;</span><span class="p">,</span> <span class="n">StompSpec</span><span class="o">.</span><span class="n">MESSAGE_ID_HEADER</span><span class="p">:</span> <span class="s">&#39;007&#39;</span><span class="p">},</span> <span class="s">&#39;hello&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="nb">repr</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
<span class="go">StompFrame(command=u&#39;MESSAGE&#39;, headers={u&#39;destination&#39;: &#39;/queue/test&#39;, u&#39;message-id&#39;: &#39;007&#39;}, body=&#39;hello&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">commands</span><span class="o">.</span><span class="n">message</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s">&#39;1.0&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">token</span> <span class="c"># This message matches your subscription.</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">commands</span><span class="o">.</span><span class="n">message</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s">&#39;1.1&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">stompest.error.StompProtocolError: Invalid MESSAGE frame (subscription header mandatory in version 1.1) [headers={&#39;destination&#39;: &#39;/queue/test&#39;, &#39;message-id&#39;</span>: <span class="n">&#39;007&#39;}]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="nb">repr</span><span class="p">(</span><span class="n">commands</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="n">receipt</span><span class="o">=</span><span class="s">&#39;message-12345&#39;</span><span class="p">))</span>
<span class="go">StompFrame(command=u&#39;DISCONNECT&#39;, headers={u&#39;receipt&#39;: &#39;message-12345&#39;}, body=&#39;&#39;)</span>
</pre></div>
</div>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">Specification of STOMP protocols <a class="reference external" href="http://stomp.github.com//stomp-specification-1.0.html">1.0</a> and <a class="reference external" href="http://stomp.github.com//stomp-specification-1.1.html">1.1</a>, your favorite broker&#8217;s documentation for additional STOMP headers.</p>
</div>
<dl class="function">
<dt id="stompest.protocol.commands.abort">
<tt class="descclassname">stompest.protocol.commands.</tt><tt class="descname">abort</tt><big>(</big><em>transaction</em>, <em>receipt=None</em><big>)</big><a class="headerlink" href="#stompest.protocol.commands.abort" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an <strong>ABORT</strong> frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>transaction</strong> &#8211; The id of the transaction.</li>
<li><strong>receipt</strong> &#8211; See <a class="reference internal" href="#stompest.protocol.commands.disconnect" title="stompest.protocol.commands.disconnect"><tt class="xref py py-meth docutils literal"><span class="pre">disconnect()</span></tt></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.ack">
<tt class="descclassname">stompest.protocol.commands.</tt><tt class="descname">ack</tt><big>(</big><em>frame</em>, <em>transactions=None</em>, <em>receipt=None</em>, <em>version=None</em><big>)</big><a class="headerlink" href="#stompest.protocol.commands.ack" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an <strong>ACK</strong> frame for a received <strong>MESSAGE</strong> frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>frame</strong> &#8211; The <a class="reference internal" href="#stompest.protocol.frame.StompFrame" title="stompest.protocol.frame.StompFrame"><tt class="xref py py-class docutils literal"><span class="pre">StompFrame</span></tt></a> object representing the <strong>MESSAGE</strong> frame we wish to ack.</li>
<li><strong>transactions</strong> &#8211; The ids of currently active transactions &#8212; only if the <strong>frame</strong> is part of one of these transactions, the <strong>transaction</strong> header is included in the ACK frame.</li>
<li><strong>receipt</strong> &#8211; See <a class="reference internal" href="#stompest.protocol.commands.disconnect" title="stompest.protocol.commands.disconnect"><tt class="xref py py-func docutils literal"><span class="pre">disconnect()</span></tt></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.beat">
<tt class="descclassname">stompest.protocol.commands.</tt><tt class="descname">beat</tt><big>(</big><em>version=None</em><big>)</big><a class="headerlink" href="#stompest.protocol.commands.beat" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a STOMP heart-beat.</p>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.begin">
<tt class="descclassname">stompest.protocol.commands.</tt><tt class="descname">begin</tt><big>(</big><em>transaction</em>, <em>receipt=None</em><big>)</big><a class="headerlink" href="#stompest.protocol.commands.begin" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <strong>BEGIN</strong> frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>transaction</strong> &#8211; The id of the transaction.</li>
<li><strong>receipt</strong> &#8211; See <a class="reference internal" href="#stompest.protocol.commands.disconnect" title="stompest.protocol.commands.disconnect"><tt class="xref py py-meth docutils literal"><span class="pre">disconnect()</span></tt></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.commit">
<tt class="descclassname">stompest.protocol.commands.</tt><tt class="descname">commit</tt><big>(</big><em>transaction</em>, <em>receipt=None</em><big>)</big><a class="headerlink" href="#stompest.protocol.commands.commit" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <strong>COMMIT</strong> frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>transaction</strong> &#8211; The id of the transaction.</li>
<li><strong>receipt</strong> &#8211; See <a class="reference internal" href="#stompest.protocol.commands.disconnect" title="stompest.protocol.commands.disconnect"><tt class="xref py py-meth docutils literal"><span class="pre">disconnect()</span></tt></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.connect">
<tt class="descclassname">stompest.protocol.commands.</tt><tt class="descname">connect</tt><big>(</big><em>login=None</em>, <em>passcode=None</em>, <em>headers=None</em>, <em>versions=None</em>, <em>host=None</em>, <em>heartBeats=None</em><big>)</big><a class="headerlink" href="#stompest.protocol.commands.connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <strong>CONNECT</strong> frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>login</strong> &#8211; The <strong>login</strong> header. The default is <tt class="xref py py-obj docutils literal"><span class="pre">None</span></tt>, which means that no such header will be added.</li>
<li><strong>passcode</strong> &#8211; The <strong>passcode</strong> header. The default is <tt class="xref py py-obj docutils literal"><span class="pre">None</span></tt>, which means that no such header will be added.</li>
<li><strong>headers</strong> &#8211; Additional STOMP headers.</li>
<li><strong>versions</strong> &#8211; A list of the STOMP versions we wish to support. The default is <tt class="xref py py-obj docutils literal"><span class="pre">None</span></tt>, which means that we will offer the broker to accept any version prior or equal to the default STOMP protocol version.</li>
<li><strong>host</strong> &#8211; The <strong>host</strong> header which gives this client a human readable name on the broker side.</li>
<li><strong>heartBeats</strong> &#8211; A pair (client heart-beat, server heart-beat) of integer heart-beat intervals in ms. Both intervals must be non-negative. A client heart-beat of 0 means that no heart-beats will be sent by the client. Similarly, a server heart-beat of 0 means that the client does not expect heart-beats from the server.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.connected">
<tt class="descclassname">stompest.protocol.commands.</tt><tt class="descname">connected</tt><big>(</big><em>frame</em>, <em>versions=None</em><big>)</big><a class="headerlink" href="#stompest.protocol.commands.connected" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle a <strong>CONNECTED</strong> frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>versions</strong> &#8211; The same <strong>versions</strong> parameter you used to create the <strong>CONNECT</strong> frame.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.disconnect">
<tt class="descclassname">stompest.protocol.commands.</tt><tt class="descname">disconnect</tt><big>(</big><em>receipt=None</em><big>)</big><a class="headerlink" href="#stompest.protocol.commands.disconnect" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <strong>DISCONNECT</strong> frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>receipt</strong> &#8211; Add a <strong>receipt</strong> header with this id to request a <strong>RECEIPT</strong> frame from the broker. If <tt class="xref py py-obj docutils literal"><span class="pre">None</span></tt>, no such header is added.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.error">
<tt class="descclassname">stompest.protocol.commands.</tt><tt class="descname">error</tt><big>(</big><em>frame</em>, <em>version</em><big>)</big><a class="headerlink" href="#stompest.protocol.commands.error" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle an <strong>ERROR</strong> frame. Does not really do anything except checking that this is an <strong>ERROR</strong> frame.</p>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.message">
<tt class="descclassname">stompest.protocol.commands.</tt><tt class="descname">message</tt><big>(</big><em>frame</em>, <em>version</em><big>)</big><a class="headerlink" href="#stompest.protocol.commands.message" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle a <strong>MESSAGE</strong> frame. Returns a token which you can use to match this message to its subscription.</p>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">The <a class="reference internal" href="#stompest.protocol.commands.subscribe" title="stompest.protocol.commands.subscribe"><tt class="xref py py-func docutils literal"><span class="pre">subscribe()</span></tt></a> command.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.nack">
<tt class="descclassname">stompest.protocol.commands.</tt><tt class="descname">nack</tt><big>(</big><em>frame</em>, <em>transactions=None</em>, <em>receipt=None</em>, <em>version=None</em><big>)</big><a class="headerlink" href="#stompest.protocol.commands.nack" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <strong>NACK</strong> frame for a received <strong>MESSAGE</strong> frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>frame</strong> &#8211; The <a class="reference internal" href="#stompest.protocol.frame.StompFrame" title="stompest.protocol.frame.StompFrame"><tt class="xref py py-class docutils literal"><span class="pre">StompFrame</span></tt></a> object representing the <strong>MESSAGE</strong> frame we wish to nack.</li>
<li><strong>transactions</strong> &#8211; The ids of currently active transactions &#8212; only if the <strong>frame</strong> is part of one of these transactions, the <strong>transaction</strong> header is included in the NACK frame.</li>
<li><strong>receipt</strong> &#8211; See <a class="reference internal" href="#stompest.protocol.commands.disconnect" title="stompest.protocol.commands.disconnect"><tt class="xref py py-func docutils literal"><span class="pre">disconnect()</span></tt></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.receipt">
<tt class="descclassname">stompest.protocol.commands.</tt><tt class="descname">receipt</tt><big>(</big><em>frame</em>, <em>version</em><big>)</big><a class="headerlink" href="#stompest.protocol.commands.receipt" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle a <strong>RECEIPT</strong> frame. Returns the receipt id which you can use to match this receipt to the command that requested it.</p>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.send">
<tt class="descclassname">stompest.protocol.commands.</tt><tt class="descname">send</tt><big>(</big><em>destination</em>, <em>body=''</em>, <em>headers=None</em>, <em>receipt=None</em><big>)</big><a class="headerlink" href="#stompest.protocol.commands.send" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <strong>SEND</strong> frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>destination</strong> &#8211; Destination for the frame.</li>
<li><strong>body</strong> &#8211; Message body. Binary content is allowed but must be accompanied by the STOMP header <strong>content-length</strong> which specifies the number of bytes in the message body.</li>
<li><strong>headers</strong> &#8211; Additional STOMP headers.</li>
<li><strong>receipt</strong> &#8211; See <a class="reference internal" href="#stompest.protocol.commands.disconnect" title="stompest.protocol.commands.disconnect"><tt class="xref py py-func docutils literal"><span class="pre">disconnect()</span></tt></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.stomp">
<tt class="descclassname">stompest.protocol.commands.</tt><tt class="descname">stomp</tt><big>(</big><em>login=None</em>, <em>passcode=None</em>, <em>headers=None</em>, <em>versions=None</em>, <em>host=None</em>, <em>heartBeats=None</em><big>)</big><a class="headerlink" href="#stompest.protocol.commands.stomp" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <strong>STOMP</strong> frame. Not supported in STOMP protocol 1.0, synonymous to <a class="reference internal" href="#stompest.protocol.commands.connect" title="stompest.protocol.commands.connect"><tt class="xref py py-func docutils literal"><span class="pre">connect()</span></tt></a> for STOMP protocol 1.1 and higher.</p>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.subscribe">
<tt class="descclassname">stompest.protocol.commands.</tt><tt class="descname">subscribe</tt><big>(</big><em>destination</em>, <em>headers</em>, <em>receipt=None</em>, <em>version=None</em><big>)</big><a class="headerlink" href="#stompest.protocol.commands.subscribe" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a pair (frame, token) of a <strong>SUBSCRIBE</strong> frame and a token which you have to keep if you wish to match incoming <strong>MESSAGE</strong> frames to this subscription  with <a class="reference internal" href="#stompest.protocol.commands.message" title="stompest.protocol.commands.message"><tt class="xref py py-func docutils literal"><span class="pre">message()</span></tt></a> or to <a class="reference internal" href="#stompest.protocol.commands.unsubscribe" title="stompest.protocol.commands.unsubscribe"><tt class="xref py py-func docutils literal"><span class="pre">unsubscribe()</span></tt></a> later.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>destination</strong> &#8211; Destination for the subscription.</li>
<li><strong>headers</strong> &#8211; Additional STOMP headers.</li>
<li><strong>receipt</strong> &#8211; See <a class="reference internal" href="#stompest.protocol.commands.disconnect" title="stompest.protocol.commands.disconnect"><tt class="xref py py-func docutils literal"><span class="pre">disconnect()</span></tt></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.unsubscribe">
<tt class="descclassname">stompest.protocol.commands.</tt><tt class="descname">unsubscribe</tt><big>(</big><em>token</em>, <em>receipt=None</em>, <em>version=None</em><big>)</big><a class="headerlink" href="#stompest.protocol.commands.unsubscribe" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an <strong>UNSUBSCRIBE</strong> frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>token</strong> &#8211; The result of the <a class="reference internal" href="#stompest.protocol.commands.subscribe" title="stompest.protocol.commands.subscribe"><tt class="xref py py-func docutils literal"><span class="pre">subscribe()</span></tt></a> command which you used to initiate the subscription in question.</li>
<li><strong>receipt</strong> &#8211; See <a class="reference internal" href="#stompest.protocol.commands.disconnect" title="stompest.protocol.commands.disconnect"><tt class="xref py py-meth docutils literal"><span class="pre">disconnect()</span></tt></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.version">
<tt class="descclassname">stompest.protocol.commands.</tt><tt class="descname">version</tt><big>(</big><em>version=None</em><big>)</big><a class="headerlink" href="#stompest.protocol.commands.version" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether <strong>version</strong> is a valid STOMP protocol version.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>version</strong> &#8211; A candidate version, or <tt class="xref py py-obj docutils literal"><span class="pre">None</span></tt> (which is equivalent to the value of <tt class="xref py py-attr docutils literal"><span class="pre">StompSpec.DEFAULT_VERSION</span></tt>).</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="stompest.protocol.commands.versions">
<tt class="descclassname">stompest.protocol.commands.</tt><tt class="descname">versions</tt><big>(</big><em>version</em><big>)</big><a class="headerlink" href="#stompest.protocol.commands.versions" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain all versions prior or equal to <strong>version</strong>.</p>
</dd></dl>

</div>
<div class="section" id="module-stompest.protocol.spec">
<span id="stomp-protocol-specification"></span><span id="spec"></span><h2>STOMP Protocol Specification<a class="headerlink" href="#module-stompest.protocol.spec" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="stompest.protocol.spec.StompSpec">
<em class="property">class </em><tt class="descclassname">stompest.protocol.spec.</tt><tt class="descname">StompSpec</tt><a class="headerlink" href="#stompest.protocol.spec.StompSpec" title="Permalink to this definition">¶</a></dt>
<dd><p>This class hosts all constants related to the STOMP protocol specification in its various versions. There really isn&#8217;t much to document, but you are invited to take a look at all available constants in the source code. Wait a minute ... one attribute is particularly noteworthy, name <tt class="xref py py-attr docutils literal"><span class="pre">DEFAULT_VERSION</span></tt> &#8212; which currently is <tt class="xref py py-obj docutils literal"><span class="pre">'1.0'</span></tt> (but this may change in upcoming stompest releases, so you&#8217;re advised to always explicitly define which STOMP protocol version you are going to use).</p>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">Specification of STOMP protocols <a class="reference external" href="http://stomp.github.com//stomp-specification-1.0.html">1.0</a> and <a class="reference external" href="http://stomp.github.com//stomp-specification-1.1.html">1.1</a>, your favorite broker&#8217;s documentation for additional STOMP headers.</p>
</div>
</dd></dl>

</div>
<div class="section" id="module-stompest.protocol.parser">
<span id="wire-level-parser"></span><span id="parser"></span><h2>Wire-Level Parser<a class="headerlink" href="#module-stompest.protocol.parser" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="stompest.protocol.parser.StompParser">
<em class="property">class </em><tt class="descclassname">stompest.protocol.parser.</tt><tt class="descname">StompParser</tt><big>(</big><em>version=None</em><big>)</big><a class="headerlink" href="#stompest.protocol.parser.StompParser" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a parser for a wire-level byte-stream of STOMP frames.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>version</strong> &#8211; A valid STOMP protocol version, or <tt class="xref py py-obj docutils literal"><span class="pre">None</span></tt> (equivalent to the <tt class="xref py py-attr docutils literal"><span class="pre">DEFAULT_VERSION</span></tt> attribute of the <a class="reference internal" href="#stompest.protocol.spec.StompSpec" title="stompest.protocol.spec.StompSpec"><tt class="xref py py-class docutils literal"><span class="pre">StompSpec</span></tt></a> class).</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">stompest.protocol</span> <span class="kn">import</span> <span class="n">StompParser</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">messages</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;RECEIPT</span><span class="se">\n</span><span class="s">receipt-id:message-12345</span><span class="se">\n\n\x00</span><span class="s">&#39;</span><span class="p">,</span> <span class="s">&#39;NACK</span><span class="se">\n</span><span class="s">subscription:0</span><span class="se">\n</span><span class="s">message-id:007</span><span class="se">\n\n\x00</span><span class="s">&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span> <span class="o">=</span> <span class="n">StompParser</span><span class="p">(</span><span class="s">&#39;1.0&#39;</span><span class="p">)</span> <span class="c"># STOMP 1.0 does not support the NACK command.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">messages</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">parser</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
<span class="gp">... </span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">2</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">stompest.error.StompFrameError: Invalid command</span>: <span class="n">u&#39;NACK&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="nb">repr</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
<span class="go">StompFrame(command=&#39;RECEIPT&#39;, headers={u&#39;receipt-id&#39;: u&#39;message-12345&#39;}, body=&#39;&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">parser</span><span class="o">.</span><span class="n">canRead</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">parser</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="go">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span> <span class="o">=</span> <span class="n">StompParser</span><span class="p">(</span><span class="s">&#39;1.1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">messages</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="nb">repr</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
<span class="go">StompFrame(command=u&#39;NACK&#39;, headers={u&#39;message-id&#39;: u&#39;007&#39;, u&#39;subscription&#39;: u&#39;0&#39;}, body=&#39;&#39;)</span>
</pre></div>
</div>
<dl class="method">
<dt id="stompest.protocol.parser.StompParser.add">
<tt class="descname">add</tt><big>(</big><em>data</em><big>)</big><a class="headerlink" href="#stompest.protocol.parser.StompParser.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a byte-stream of wire-level data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> &#8211; An iterable of characters. If any character evaluates to <tt class="xref py py-obj docutils literal"><span class="pre">False</span></tt>, that stream will no longer be consumed.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.parser.StompParser.canRead">
<tt class="descname">canRead</tt><big>(</big><big>)</big><a class="headerlink" href="#stompest.protocol.parser.StompParser.canRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicates whether there are frames available.</p>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.parser.StompParser.get">
<tt class="descname">get</tt><big>(</big><big>)</big><a class="headerlink" href="#stompest.protocol.parser.StompParser.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the next frame as a <a class="reference internal" href="#stompest.protocol.frame.StompFrame" title="stompest.protocol.frame.StompFrame"><tt class="xref py py-class docutils literal"><span class="pre">StompFrame</span></tt></a> object (if any), or <tt class="xref py py-obj docutils literal"><span class="pre">None</span></tt> (otherwise).</p>
</dd></dl>

<dl class="method">
<dt id="stompest.protocol.parser.StompParser.reset">
<tt class="descname">reset</tt><big>(</big><big>)</big><a class="headerlink" href="#stompest.protocol.parser.StompParser.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset internal state, including all fully or partially parsed frames.</p>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="config.html" title="Configuration"
             >next</a> |</li>
        <li class="right" >
          <a href="async.html" title="Asynchronous Client"
             >previous</a> |</li>
        <li><a href="index.html">stompest documentation - v2.0a3</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Jan Müller.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>